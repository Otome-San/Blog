<!-- blog.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-bootstrap@0.1.0/dist/bundle.min.js"></script>
    <title>Blog</title>
    <style>
        body {
            background-color: #f8f9fa;
        }
        .navbar {
            background-color: #343a40;
        }
        .blog-post {
            background-color: #ffffff;
            margin-bottom: 20px;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .footer {
            background-color: #343a40;
            color: #ffffff;
            text-align: center;
            padding: 10px 0;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <a class="navbar-brand" href="#">Mi Blog</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="#">Inicio</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Categorías</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Acerca de</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Contacto</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Usuario: <span id=""></span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" id="logoutBtn">Cerrar Sesión</a>
                </li>
            </ul>
        </div>
    </nav>

    <div class="container mt-4">
        <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="styles.css">
    <title>Mi Red Social</title>
</head>
<body>
    <div class="row">
            <div class="col-md-3">
                <!-- Barra lateral con información del perfil y enlaces -->
                <div class="card">
                    <img src="/1fdff0a59a01f7f37c2b6aa70c7d81fb.jpg" class="card-img-top" alt="Foto de perfil">
                    <div class="card-body">
                        <h5 class="card-title"><span id="loggedInUser"></span></h5>
                        <p class="card-text">Información del perfil...</p>
                        <!-- Agrega aquí enlaces adicionales o información del perfil -->
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div>
                    <textarea id="postInput" class="form-control mb-2" placeholder="¿Qué estás pensando?"></textarea>
                    <button onclick="publishPost()" class="btn btn-primary">Publicar</button>
                </div>
                <div id="postsContainer">
                    <!-- Aquí se mostrarán las publicaciones -->
                </div>
            </div>
            <div class="col-md-3">
                <!-- Barra lateral con sugerencias de amigos, anuncios, etc. -->
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Sugerencias</h5>
                        <!-- Aquí irán las sugerencias de amigos -->
                    </div>
                </div>
                <!-- Puedes agregar más widgets, anuncios, etc. -->
            </div>
        </div>

    <div class="container mt-4">
        
    </div>

    <!-- Scripts de Bootstrap y otros scripts -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.0.8/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
    </div>

    <footer class="footer bg-dark text-white">
        <p>&copy; 2023 Mi Blog. Todos los derechos reservados.</p>
    </footer>

    <!-- Scripts de Bootstrap y jQuery (necesarios para ciertos componentes de Bootstrap) -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.0.8/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        // Función para obtener el usuario actualmente autenticado
        function getLoggedInUser() {
            fetch('http://localhost:3000/user')
                .then(response => response.json())
                .then(user => {
                    const loggedInUserElement = document.getElementById('loggedInUser');
                    if (user) {
                        loggedInUserElement.innerText = user.username;
                    } else {
                        loggedInUserElement.innerText = 'Usuario no autenticado';
                    }
                })
                .catch(error => {
                    console.error('Error al obtener el usuario autenticado:', error);
                });
        }

        // Función para cerrar sesión
        function logout() {
            fetch('http://localhost:3000/logout', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
            })
            .then(response => response.json())
            .then(data => {
                alert(data.message);

                if (data.success) {
                    // Redirige a login.html después de cerrar sesión
                    window.location.href = 'login.html';
                }
            })
            .catch(error => {
                console.error('Error al cerrar sesión:', error);
            });
        }


        // Al cargar la página, obtén el usuario actualmente autenticado
        document.addEventListener('DOMContentLoaded', function () {
            getLoggedInUser();

            // Configura el evento de clic para el botón de cierre de sesión
            document.getElementById('logoutBtn').addEventListener('click', function (event) {
                event.preventDefault();
                logout();
            });
        });


        document.getElementById('postForm').addEventListener('submit', function (event) {
    event.preventDefault();

    const title = document.getElementById('postTitle').value;
    const content = document.getElementById('postContent').value;

    fetch('http://localhost:3000/create-post', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ title, content }),
    })
    .then(response => response.json())
    .then(data => {
        console.log(data.message);
        // Puedes realizar alguna acción adicional después de crear la publicación
    })
    .catch(error => {
        console.error('Error al crear la publicación:', error);
    });
});
</script>
<!-- Agrega este script al final de tu cuerpo HTML -->
<script>
    // Función para generar datos aleatorios
    function generateRandomData() {
        return Array.from({ length: 12 }, () => Math.floor(Math.random() * 100));
    }

    // Configuración común para los gráficos
    const commonConfig = {
        type: 'bar',
        data: {
            labels: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'],
            datasets: [{
                label: 'Datos Aleatorios',
                data: generateRandomData(),
                backgroundColor: 'rgba(75, 192, 192, 0.2)',
                borderColor: 'rgba(75, 192, 192, 1)',
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    };

    // Inicializa los gráficos
    const chart1 = new Chart(document.getElementById('chart1').getContext('2d'), commonConfig);
    const chart2 = new Chart(document.getElementById('chart2').getContext('2d'), commonConfig);
    const chart3 = new Chart(document.getElementById('chart3').getContext('2d'), commonConfig);
    const chart4 = new Chart(document.getElementById('chart4').getContext('2d'), commonConfig);
</script>


</body>
</html>
